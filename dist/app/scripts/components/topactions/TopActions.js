define(["react","jsx!components/objectfinder/ObjectFinder","jsx!components/countindicator/CountIndicator","actions/client"],function(a,b,c,d){var e=a.createClass({displayName:"TopActions",componentDidMount:function(){$(".desktop").on("click",this._onDocumentClick)},componentWillUnmount:function(){$(".desktop").off("click",this._onDocumentClick)},render:function(){var d;return this.props.unreadNotificationsCount&&(d=c({count:this.props.unreadNotificationsCount,offset:-13})),a.DOM.div({className:"top-actions flex"},a.DOM.div({className:"action-trigger flex flex-align-center",dataAutoClose:"true",ref:"search_trigger",onClick:this._onActionClick.bind(this,"search_trigger")},a.DOM.i({className:"fa fa-search"}),a.DOM.div({className:"action-view",onClick:this._onActionViewClick},b({services:this.props.services,closeAction:this._closeAction.bind(this,"search_trigger")}))),a.DOM.div({className:"action-trigger flex flex-align-center",ref:"notifications_trigger",onClick:this._onActionClick.bind(this,"notifications_trigger")},a.DOM.i({className:"fa fa-flag"})),a.DOM.div({className:"unread-notifications-counter"},d))},_getActiveActionRef:function(){return _.filter(this.refs,function(a){return $(a.getDOMNode()).hasClass("active")}.bind(this))[0]},_closeAction:function(a){this.refs[a]&&$(this.refs[a].getDOMNode()).removeClass("active")},_onActionClick:function(a){var b=this._getActiveActionRef();if(b&&b.props.ref!=a&&b.props.dataAutoClose&&$(b.getDOMNode()).removeClass("active"),b=null,this.refs[a]){var c=$(this.refs[a].getDOMNode());switch(c.toggleClass("active"),a){case"search_trigger":c.hasClass("active")&&$(".object-finder .finder-query input").focus();break;case"notifications_trigger":d.toggleNotificationsPanel(c.hasClass("active"))}}},_onActionViewClick:function(a){return a.preventDefault(),a.stopPropagation(),!1},_onDocumentClick:function(){var a=this._getActiveActionRef();a&&a.props.dataAutoClose&&$(a.getDOMNode()).removeClass("active"),a=null}});return e});
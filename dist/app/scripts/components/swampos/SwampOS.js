define(["react","jsx!components/topmenu/TopMenu","jsx!components/desktop/Desktop","jsx!components/notificationspanel/NotificationsPanel","jsx!components/applicationprompt/ApplicationPrompt","jsx!components/contextmenu/ContextMenu","stores/swampApplicationStore","stores/swampLogsStore","stores/swampServicesStore","stores/swampPluginsStore","stores/menuItemsStore","stores/swampWindowsStore","stores/swampIconsStore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){return{logs:h.getAll(),services:i.getAll(),plugins:j.getAll(),servicesCount:i.count(),runningServicesCount:i.runningServicesCount(),stoppedServicesCount:i.stoppedServiceCount(),unreadNotificationsCount:h.getUnreadCount(),menu:k.getAll(),windows:l.getAll(),icons:m.getAll()}}var o=300,p=a.createClass({displayName:"SwampOS",getInitialState:function(){return n()},componentDidMount:function(){this._throttledChangeHandler=_.throttle(this._onChange,o,{leading:!0}),g.addChangeListener(this._throttledChangeHandler),i.addChangeListener(this._throttledChangeHandler),j.addChangeListener(this._throttledChangeHandler),h.addChangeListener(this._throttledChangeHandler),k.addChangeListener(this._throttledChangeHandler),l.addChangeListener(this._throttledChangeHandler),m.addChangeListener(this._throttledChangeHandler)},componentWillUnmount:function(){g.removeChangeListener(this._throttledChangeHandler),h.removeChangeListener(this._throttledChangeHandler),i.removeChangeListener(this._throttledChangeHandler),j.removeChangeListener(this._throttledChangeHandler),k.removeChangeListener(this._throttledChangeHandler),l.removeChangeListener(this._throttledChangeHandler),m.removeChangeListener(this._throttledChangeHandler),this._throttledChangeHandler=null},render:function(){return a.DOM.div({className:"swamp-os flex flex-vbox"},this._getApplicationPrompt(),b({items:this.state.menu,services:this.state.services,plugins:this.state.plugins,servicesCount:this.state.servicesCount,runningServicesCount:this.state.runningServicesCount,stoppedServicesCount:this.state.stoppedServicesCount,unreadNotificationsCount:this.state.unreadNotificationsCount}),d({isOpen:h.isPanelOpen(),logs:this.state.logs}),c({isNotificationsPanelOpen:h.isPanelOpen(),windows:this.state.windows,icons:this.state.icons}),this._getContextMenu())},_onChange:function(){this.setState(n())},_getApplicationPrompt:function(){return g.hasPrompt()?e({prompt:g.getPrompt()}):null},_getContextMenu:function(){return g.hasContextMenu()?f({options:g.getContextMenu()}):void 0}});return p});